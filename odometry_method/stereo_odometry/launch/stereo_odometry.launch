<launch>

  <!-- sim time for convenience, if playing a rosbag -->
  <arg name="use_sim_time" default="true" />
  <param if="$(arg use_sim_time)" name="use_sim_time" value="true" />

  <!-- Corresponding config files -->
  <arg name="cfg" default="$(find stereo_odometry)/config/config.ini" /> <!-- To change RTAB-Map's parameters, set the path of config file (*.ini) generated by the standalone app -->

  <!-- <arg name="initial_pose" default="0 0 0 0 0 0" />  -->
  <arg name="frame_id" default="base_link" /> <!-- Fixed frame id, you may set "base_link" or "base_footprint" if they are published -->
  <arg name="odom_frame_id" default="odom" /> <!-- If set, TF is used to get odometry instead of the topic -->
  <arg name="ground_truth_frame_id" default="" /> <!-- e.g., "world" -->
  <arg name="ground_truth_base_frame_id" default="" /> <!-- e.g., "tracker", a fake frame matching the frame "frame_id" (but on different TF tree) -->
  <arg name="queue_size" default="10" />
  <arg name="wait_for_transform" default="0.2" />
  <arg name="args" default="" /> <!-- delete_db_on_start, udebug -->
  <arg name="rtabmap_args" default="$(arg args)" /> <!-- deprecated, use "args" argument -->
  <arg name="launch_prefix" default="" /> <!-- for debugging purpose, it fills launch-prefix tag of the nodes -->
  <arg name="output" default="log" /> <!-- Control node output (screen or log) -->
  <arg name="approx_sync" default="true" /> <!-- if timestamps of the input topics are not synchronized -->

  <arg name="rgbd_sync" default="false" /> <!-- pre-sync rgb_topic, depth_topic, camera_info_topic -->
  <arg name="approx_rgbd_sync" default="false" /> <!-- false=exact synchronization -->
  <arg name="subscribe_rgbd" default="$(arg rgbd_sync)" />

  <!-- stereo related topics -->
  <arg name="stereo_namespace" default="/wide_stereo" />
  <arg name="left_image_topic" default="$(arg stereo_namespace)/left/image_rect_color" />
  <arg name="right_image_topic" default="$(arg stereo_namespace)/right/image_rect" /> <!-- using grayscale image for efficiency -->
  <arg name="left_camera_info_topic" default="$(arg stereo_namespace)/left/camera_info" />
  <arg name="right_camera_info_topic" default="$(arg stereo_namespace)/right/camera_info" />

  <arg name="odom_topic" default="vio_odom" /> <!-- Odometry topic name -->
  <arg name="vo_frame_id" default="odom" /> <!-- Visual/Icp odometry frame ID for TF -->
  <arg name="publish_tf_odom" default="false" />
  <arg name="odom_tf_angular_variance" default="1" /> <!-- If TF is used to get odometry, this is the default angular variance -->
  <arg name="odom_args" default="" /> <!-- More arguments for odometry (overwrite same parameters in rtabmap_args) -->
  <arg name="odom_guess_frame_id" default="" />
  <arg name="odom_guess_min_translation" default="0" />
  <arg name="odom_guess_min_rotation" default="0" />
  <arg name="odom_max_rate" default="0" />
  <arg name="odom_expected_rate" default="0" />
  <arg name="imu_topic" default="/imu" /> <!-- only used with VIO approaches -->
  <arg name="wait_imu_to_init" default="true" />

  <node pkg="rtabmap_ros" type="stereo_odometry" name="stereo_odometry" output="$(arg output)" args="$(arg rtabmap_args) $(arg odom_args)" launch-prefix="$(arg launch_prefix)">
    <remap from="left/image_rect" to="$(arg left_image_topic)" />
    <remap from="right/image_rect" to="$(arg right_image_topic)" />
    <remap from="left/camera_info" to="$(arg left_camera_info_topic)" />
    <remap from="right/camera_info" to="$(arg right_camera_info_topic)" />
    <!-- <remap from="rgbd_image" to="$(arg rgbd_topic_relay)" /> -->
    <remap from="odom" to="$(arg odom_topic)" />
    <remap from="imu" to="$(arg imu_topic)" />

    <!-- <param name="initial_pose" type="string" value="$(arg initial_pose)" /> -->
    <param name="frame_id" type="string" value="$(arg frame_id)" />
    <param name="odom_frame_id" type="string" value="$(arg vo_frame_id)" />
    <param name="publish_tf" type="bool" value="$(arg publish_tf_odom)" />
    <param name="ground_truth_frame_id" type="string" value="$(arg ground_truth_frame_id)" />
    <param name="ground_truth_base_frame_id" type="string" value="$(arg ground_truth_base_frame_id)" />
    <param name="wait_for_transform_duration" type="double" value="$(arg wait_for_transform)" />
    <param name="wait_imu_to_init" type="bool" value="$(arg wait_imu_to_init)" />
    <param name="approx_sync" type="bool" value="$(arg approx_sync)" />
    <param name="config_path" type="string" value="$(arg cfg)" />
    <param name="queue_size" type="int" value="$(arg queue_size)" />
    <param name="subscribe_rgbd" type="bool" value="$(arg subscribe_rgbd)" />
    <param name="guess_frame_id" type="string" value="$(arg odom_guess_frame_id)" />
    <param name="guess_min_translation" type="double" value="$(arg odom_guess_min_translation)" />
    <param name="guess_min_rotation" type="double" value="$(arg odom_guess_min_rotation)" />
    <param name="expected_update_rate" type="double" value="$(arg odom_expected_rate)" />
    <param name="max_update_rate" type="double" value="$(arg odom_max_rate)" />
  </node>

  
</launch>